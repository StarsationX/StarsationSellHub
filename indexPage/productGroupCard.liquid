<div class="group basis-[324px] md:max-w-[324px] h-full bg-gradient-to-b from-white/5 via-white/5 to-transparent shadow-lg backdrop-blur-sm flex-1 flex flex-col p-3 rounded-3xl border border-white/10 duration-300 w-full relative hover:-translate-y-1 hover:border-[--accent-color]/40 hover:shadow-[0_20px_60px_-35px_rgba(0,0,0,0.9)]">
  <dialog>
    <dialog-trigger>
      <span class="absolute top-4 right-4 text-[10px] uppercase tracking-wide bg-[--accent-color] px-2.5 py-1 rounded-full text-white font-semibold w-fit shadow-md">Group</span>
      {% assign checkArray = product.image | split: 'yt:' %}

      <div class="relative overflow-hidden rounded-2xl">
        {% if checkArray[1] %}
          <iframe
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowFullScreen="false"
            class="w-full object-cover h-[182px] rounded-2xl overflow-hidden"
            frameBorder="0"
            height="182"
            src="https://www.youtube.com/embed/{{ checkArray[1] }}"
            title="YouTube video player"
            width="450"></iframe>
        {% else %}
          <Image
            src="{{product.image | default: '/images/no_image_placeholder.png'}}"
            alt="{{product.name}}"
            height="182"
            width="450"
            class="w-full object-cover h-[182px] rounded-2xl overflow-hidden transition duration-300 group-hover:scale-[1.02]"></Image>
        {% endif %}
        <div class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
      </div>

      <div class="mt-3 flex flex-row justify-between items-start gap-3">
        <div class="text-left font-semibold text-lg flex-1 leading-snug">
          {{ product.name }}
        </div>
        <div class="flex flex-row items-end justify-between">
          {% if product.stockVisible %}
            <div class="text-[11px]">
              {% if product.stockCount > 0 %}
                <span class="px-2.5 py-1 rounded-full bg-green-500/15 text-green-400">{{ product.stockCount }} In Stock</span>
              {% else %}
                <span class="px-2.5 py-1 rounded-full bg-red-500/15 text-red-400">Out of Stock</span>
              {% endif %}
            </div>
          {% endif %}
        </div>
      </div>
      <div class="mt-4 flex w-full flex-row items-end gap-3">
        <button class="duration-200 inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-semibold transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 hover:bg-[--accent-color] hover:text-white px-4 py-2 h-12 w-full rounded-full border border-white/10 bg-white/5 shadow-lg group-hover:border-[--accent-color]/40">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-eye"><path d="M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0" /><circle
              cx="12"
              cy="12"
              r="3" /></svg>
          <span>View Products</span>
        </button>
        <div class="outfit flex flex-col text-right">
          <span class="text-end text-[11px] text-muted-foreground uppercase tracking-wide">Starting at</span>
          {% if product.priceSlash != 0 %}
            <span>
              <span class="font-bold text-2xl text-[--accent-color]">
                <price data-currency="{{product.baseCurrency}}" data-price="{{product.price}}"></price>
              </span>
              <span class="line-through text-sm text-white opacity-80">
                <price data-currency="{{product.baseCurrency}}" data-price="{{product.priceSlash}}"></price>
              </span>
            </span>
          {% else %}
            <span class="text-2xl font-bold text-brand text-[--accent-color]">
              <price data-currency="{{product.baseCurrency}}" data-price="{{product.price}}"></price>
            </span>
          {% endif %}
        </div>
      </div>
    </dialog-trigger>
    <dialog-content>
      <dialog-header-container>
        <dialog-header>
          <dialog-title>{{ product.name }}</dialog-title>
          <dialog-description>
            {{ product.description }}
          </dialog-description>
        </dialog-header>
      </dialog-header-container>
      <dialog-content-container>
        <div className="grid gap-4">
          <!-- Product Card of groups render below -->
          {% for groupedProduct in product.groupedProducts %}
            <div class="p-2 rounded-md bg-accent/30 flex flex-row justify-between">
              <div class="flex flex-row gap-2 w-full">
                <Image
                  width="64"
                  height="64"
                  src="{{groupedProduct.images[0] | default: '/images/no_image_placeholder.png'}}"
                  alt="{{groupedProduct.name}}"
                  class="w-16 h-16 object-cover rounded-md"></Image>
                <div class="flex flex-col justify-between w-full">
                  <div class="">
                    <div class="text-sm font-semibold line-clamp-1">{{ groupedProduct.name }}</div>
                    <div class="text-xs text-muted-foreground">Contains {{ groupedProduct.variantsCount }}
                      Product{% if groupedProduct.variantsCount > 1 %}s{% endif %}
                    </div>
                  </div>
                  <div class="flex flex-row items-end justify-between">
                    <div class="text-xs text-muted-foreground">Starting
                      <span class="font-bold text-[--accent-color]">
                        <price data-price="{{groupedProduct.priceRaw}}" data-currency="{{gropuedProduct.baseCurrency}}"></price>
                      </span>
                    </div>
                    <link-button
                      href="/product/{{groupedProduct.url}}"
                      class="bg-[--accent-color] hover:bg-[--dark-accent-color] text-xs h-6 px-2"
                      data-id="b782100d-cb9a-4697-ad14-eaeca69760f7"
                      data-label="Purchase"
                      data-variant="default"
                      data-href="/product/{{groupedProduct.url}}">
                      <span>Purchase</span>
                    </link-button>
                  </div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </dialog-content-container>
    </dialog-content>
  </dialog>
</div>
